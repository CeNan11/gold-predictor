<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gold Price Prediction</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white p-4 md:p-10">
    <div class="max-w-5xl mx-auto">
        <div class="flex flex-col md:flex-row justify-between items-center mb-10 gap-4">
            <div>
                <h1 class="text-4xl font-black text-yellow-500">GOLD AI DASHBOARD</h1>
            </div>
            <form action="/scrape-history" method="POST">
                <button type="submit" class="bg-slate-800 hover:bg-yellow-600 text-slate-300 py-3 px-6 rounded-full border border-slate-700 transition-all font-bold">
                    ðŸ”„ SYNC 30-DAY MARKET DATA
                </button>
            </form>
        </div>
        
        <div class="bg-slate-800 p-8 rounded-3xl border border-slate-700 mb-8 shadow-2xl">
            <h2 class="text-yellow-500 font-bold mb-6 uppercase text-xs tracking-widest">Prediction Parameters</h2>
            <form method="POST" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <label class="block text-xs text-slate-400 mb-2 uppercase font-semibold">Grams to Value</label>
                    <input type="number" name="grams" step="0.01" value="{{ grams }}" class="w-full bg-slate-900 border border-slate-700 rounded-xl p-4 text-yellow-400">
                </div>
                <div>
                    <label class="block text-xs text-slate-400 mb-2 uppercase font-semibold">Target Prediction Date</label>
                    <input type="date" 
                           name="target_date" 
                           value="{{ target_date }}" 
                           min="{{ labels[0] if labels else '' }}"
                           class="w-full bg-slate-900 border border-slate-700 rounded-xl p-4 text-yellow-400">
                </div>
                <div class="flex items-end">
                    <button type="submit" class="w-full bg-yellow-600 hover:bg-yellow-500 text-white font-black py-4 rounded-xl shadow-xl uppercase transition-transform active:scale-95">
                        Calculate Prediction
                    </button>
                </div>
            </form>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
            <div class="bg-slate-800 p-8 rounded-3xl border border-slate-700">
                <h2 class="text-slate-500 uppercase text-xs font-bold">Current Live Price (1g 24K)</h2>
                <p class="text-5xl font-mono mt-3 text-yellow-400">â‚±{{ "{:,.2f}".format(current) }}</p>
            </div>
            <div class="bg-slate-800 p-8 rounded-3xl border border-slate-700 border-l-4 border-l-green-500">
                <h2 class="text-slate-500 uppercase text-xs font-bold">Estimated Value on {{ target_date }}</h2>
                <p class="text-5xl font-mono mt-3 text-green-400">â‚±{{ "{:,.2f}".format(prediction) }}</p>
            </div>
        </div>
        
        <div class="bg-slate-800 p-8 rounded-3xl border border-slate-700">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-slate-400 font-bold uppercase text-xs">Market Trajectory Analysis</h3>
                <div class="flex gap-4 text-xs">
                    <span class="flex items-center gap-1"><div class="w-3 h-3 bg-yellow-500 rounded-full"></div> Actual</span>
                    <span class="flex items-center gap-1"><div class="w-3 h-3 bg-green-500 rounded-full"></div> AI Trend</span>
                </div>
            </div>
            <div class="h-80"><canvas id="goldTrendChart"></canvas></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const chartLabels = {{ labels|tojson }};
        const actualPrices = {{ actual|tojson }};
        const trendPrices = {{ trend|tojson }};

        if (chartLabels.length > 0) {
            new Chart(document.getElementById('goldTrendChart').getContext('2d'), {
                type: 'line',
                data: {
                    labels: chartLabels,
                    datasets: [
                        {
                            label: 'Actual Price',
                            data: actualPrices,
                            borderColor: '#eab308',
                            backgroundColor: '#eab308',
                            pointRadius: 4,
                            showLine: false
                        },
                        {
                            label: 'AI Trend Line',
                            data: trendPrices,
                            borderColor: '#10b981',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            fill: true,
                            backgroundColor: 'rgba(16, 185, 129, 0.05)',
                            pointRadius: (ctx) => ctx.dataIndex === chartLabels.length - 1 ? 6 : 0,
                            pointBackgroundColor: '#10b981',
                            tension: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            grid: { color: 'rgba(255,255,255,0.05)' }, 
                            ticks: { color: '#64748b', callback: (val) => 'â‚±' + val.toLocaleString() } 
                        },
                        x: { grid: { display: false }, ticks: { color: '#64748b' } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
    </script>
</body>
</html>